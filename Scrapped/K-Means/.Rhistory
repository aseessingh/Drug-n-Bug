df
df <- read.csv("combined_df_new.csv")
find_optimal_k <- function(df, cols, max_k = 10, scale_data = TRUE) {
library(factoextra)
library(cluster)
# Subset and optionally scale the data
data <- df[, cols]
if (scale_data) {
data <- scale(data)
}
# Elbow Method
print("Elbow Method:")
elbow_plot <- fviz_nbclust(data, kmeans, method = "wss", k.max = max_k) +
ggtitle("Elbow Method for Optimal Clusters")
print(elbow_plot)
# Silhouette Method
print("Silhouette Method:")
silhouette_plot <- fviz_nbclust(data, kmeans, method = "silhouette", k.max = max_k) +
ggtitle("Silhouette Method for Optimal Clusters")
print(silhouette_plot)
}
View(df)
df[,1] <- NULL
View(df)
find_optimal_k(df,cols=12:254)
install.packages("factoextra","cluster")
install.packages("factoextra")
find_optimal_k <- function(df, cols, max_k = 10, scale_data = TRUE) {
library(factoextra)
# Subset and optionally scale the data
data <- df[, cols]
if (scale_data) {
data <- scale(data)
}
# Elbow Method
print("Elbow Method:")
elbow_plot <- fviz_nbclust(data, kmeans, method = "wss", k.max = max_k) +
ggtitle("Elbow Method for Optimal Clusters")
print(elbow_plot)
# Silhouette Method (factoextra uses its own silhouette implementation)
print("Silhouette Method:")
silhouette_plot <- fviz_nbclust(data, kmeans, method = "silhouette", k.max = max_k) +
ggtitle("Silhouette Method for Optimal Clusters")
print(silhouette_plot)
}
find_optimal_k(df,cols=12:254)
k_means <- kmeans(df[,12:254],centers = 2)
View(k_means)
k_means[["centers"]]
View(k_means)
df$Cluster <- k_means$cluster
View(df)
library(dplyr)
df <- df %>% select(SampleID,AGE,GENDERMale,GENDERFemale,CENTER_CDanemark,CENTER_CFrance,CENTER_CGermany,DOSAGE_METFORMIN_C,metformin,GLYCATHB,AG,Cluster,everything())
View(df)
df <- as.data.frame(read_csv("combined_df_new.csv"))
library(dplyr)
library(readr)
df <- as.data.frame(read_csv("combined_df_new.csv"))
View(df)
df[,1] <- NULL
find_optimal_k <- function(df, cols, max_k = 10, scale_data = TRUE) {
library(factoextra)
# Subset and optionally scale the data
data <- df[, cols]
if (scale_data) {
data <- scale(data)
}
# Elbow Method
print("Elbow Method:")
elbow_plot <- fviz_nbclust(data, kmeans, method = "wss", k.max = max_k) +
ggtitle("Elbow Method for Optimal Clusters")
print(elbow_plot)
# Silhouette Method (factoextra uses its own silhouette implementation)
print("Silhouette Method:")
silhouette_plot <- fviz_nbclust(data, kmeans, method = "silhouette", k.max = max_k) +
ggtitle("Silhouette Method for Optimal Clusters")
print(silhouette_plot)
}
find_optimal_k(df,cols=12:254)
k_means <- kmeans(df[,12:254],centers = 2)
df$Cluster <- k_means$cluster
df <- df %>% select(SampleID,AGE,GENDERMale,GENDERFemale,CENTER_CDanemark,CENTER_CFrance,CENTER_CGermany,DOSAGE_METFORMIN_C,metformin,GLYCATHB,AG,Cluster,everything())
View(df)
write_csv(df,"clustered_data.csv")
